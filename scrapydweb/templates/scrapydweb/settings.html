{% extends 'base.html' %}

{% block title %}设置{% endblock %}

{% block head %}
  <style>
  .collapse h4 {line-height: 55px;}
  </style>
{% endblock %}

{% block body %}
<h2><a class="link" target="_blank" href="{{ GITHUB_URL }}/blob/master/scrapydweb/default_settings.py">设置</a></h2>

<div class="wrap collapse-wrap">
  <ul class="collapse">
    <li>
      <div class="title"><h4>default_settings.py</h4><i class="iconfont icon-right"></i></div>
      <p>{{ DEFAULT_SETTINGS_PY_PATH }}</p>
    </li>
    <li>
      <div class="title"><h4>用户配置文件目录</h4><i class="iconfont icon-right"></i></div>
      <p>{{ SCRAPYDWEB_SETTINGS_PY_PATH }}</p>
    </li>
    <li><div class="title"><h4>主进程号: {{ MAIN_PID }}</h4></div></li>
    <li><div class="title"><h4>logparser进程号: {{ LOGPARSER_PID }}</h4></div></li>
    <li><div class="title"><h4>poll进程号: {{ POLL_PID }}</h4></div></li>
  </ul>
</div>

<div class="wrap collapse-wrap">
  <!-- <h3>Settings</h3> -->
  <ul class="collapse">

    <div class="wrap collapse-wrap">
      <h3>ScrapydWeb</h3>
      <ul class="collapse">
        <li>
          <div class="title"><h4>* 服务器 *</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ scrapydweb_server }}</pre>
        </li>
        <li>
          <div class="title"><h4>ENABLE_HTTPS = {{ ENABLE_HTTPS }}</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ enable_https_details }}</pre>
        </li>
      </ul>
    </div>

    <div class="wrap collapse-wrap">
      <h3>Scrapy</h3>
      <ul class="collapse">
        <li>
          <div class="title"><h4>SCRAPY_PROJECTS_DIR</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ SCRAPY_PROJECTS_DIR }}</pre>
        </li>
      </ul>
    </div>

    <div class="wrap collapse-wrap">
      <h3>Scrapyd</h3>
      <ul class="collapse">
        <li>
          <div class="title"><h4>* 服务器 *</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ servers }}</pre>
        </li>
        <li>
          <div class="title"><h4>LOCAL_SCRAPYD_SERVER</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ LOCAL_SCRAPYD_SERVER }}</pre>
        </li>
        <li>
          <div class="title"><h4>LOCAL_SCRAPYD_LOGS_DIR</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ LOCAL_SCRAPYD_LOGS_DIR }}</pre>
        </li>
        <li>
          <div class="title"><h4>SCRAPYD_LOG_EXTENSIONS</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ SCRAPYD_LOG_EXTENSIONS }}</pre>
        </li>
      </ul>
    </div>

    <div class="wrap collapse-wrap">
      <h3>LogParser</h3>
      <ul class="collapse">
        <li><div class="title"><h4>ENABLE_LOGPARSER = {{ ENABLE_LOGPARSER }}</h4></div></li>
        <li><div class="title"><h4>版本: {{ logparser_version }}</h4></div></li>
        <li>
          <div class="title"><h4>settings.py</h4><i class="iconfont icon-right"></i></div>
          <p>{{ logparser_settings_py_path }}</p>
        </li>
        <li><div class="title"><h4>BACKUP_STATS_JSON_FILE = {{ BACKUP_STATS_JSON_FILE }}</h4></div></li>
      </ul>
    </div>

    <div class="wrap collapse-wrap">
      <h3>定时任务</h3>
      <ul class="collapse">
        <li><div class="title"><h4>scheduler.state: {{ scheduler_state }}</h4></div></li>
        <li><div class="title"><h4>JOBS_SNAPSHOT_INTERVAL = {{ JOBS_SNAPSHOT_INTERVAL }}</h4></div></li>
      </ul>
    </div>

    <div class="wrap collapse-wrap">
      <h3>爬虫运行</h3>
      <ul class="collapse">
        <li>
          <div class="title"><h4>详情</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ run_spider_details }}</pre>
        </li>
      </ul>
    </div>

    <div class="wrap collapse-wrap">
      <h3>页面显示</h3>
      <ul class="collapse">
        <li>
          <div class="title"><h4>详情</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ page_display_details }}</pre>
        </li>
      </ul>
    </div>

    <div class="wrap collapse-wrap">
      <h3>发送消息</h3>
      <ul class="collapse">
        <li>
          <div class="title"><h4>Slack</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ slack_details }}</pre>
        </li>
        <li>
          <div class="title"><h4>Telegram</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ telegram_details }}</pre>
        </li>
        <li>
          <div class="title"><h4>Email</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ email_details }}</pre>
        </li>
        <li>
          <div class="title"><h4>email 发件人 & 收件人</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ email_sender_recipients }}</pre>
        </li>
        <li>
          <div class="title"><h4>email smtp 设置</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ email_smtp_settings }}</pre>
        </li>
      </ul>
    </div>

    <div class="wrap collapse-wrap">
      <h3>监测预警</h3>
      <ul class="collapse">
        <li><div class="title"><h4>ENABLE_MONITOR = {{ ENABLE_MONITOR }}</h4></div></li>
        <li>
          <div class="title"><h4>轮询间隔</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ poll_interval }}</pre>
        </li>
        <li>
          <div class="title"><h4>警报切换器</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ alert_switcher }}</pre>
        </li>
        <li>
          <div class="title"><h4>警报工作时间</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ alert_working_time }}</pre>
        </li>
        <li>
          <div class="title"><h4>触发器</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ alert_triggers|safe }}</pre>
        </li>
      </ul>
    </div>

    <div class="wrap collapse-wrap">
      <h3>System</h3>
      <ul class="collapse">
        <li><div class="title"><h4>DEBUG = {{ DEBUG }}</h4></div></li>
        <li><div class="title"><h4>VERBOSE = {{ VERBOSE }}</h4></div></li>
        <li>
          <div class="title"><h4>DATA_PATH</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ DATA_PATH }}</pre>
        </li>
        <li>
          <div class="title"><h4>DATABASE</h4><i class="iconfont icon-right"></i></div>
          <pre>{{ database_details }}</pre>
        </li>
      </ul>
    </div>

  </ul>
</div>

<script>
// handle collapse components
(function () {
  var collapse = my$('.collapse');
  var titles = my$$('.collapse .title');
  var lis = my$$('.collapse li');
  titles.forEach(function(title) {
    title.addEventListener('click', function(e){
      var index = [].indexOf.call(titles, this);
      lis[index].classList.toggle('active');
    });
  });
})();
</script>
{% endblock %}
